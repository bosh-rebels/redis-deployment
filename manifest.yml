name: redis

releases:
- name: redis
  sha1: ((redis_sha1))
  url: ((url))
  version: ((redis_version)) 

- name: bpm
  version: ((bpm_version))
stemcells:
- os: ((stemcell_os))
  alias: default
  version: ((stemcell_version))

instance_groups:
- name: redis
  jobs:
  - name: redis
    release: redis
    properties:
      password: ((redis_password))
    provides:
      redis:
        as: redis
  instances: ((redis_instances))
  stemcell: default
  azs: 
  - z1
  - z2
  - z3
  vm_type: ((vm_type))
  persistent_disk: ((redis_persistent_disk))
  networks:
  - name: ((network))

- name: redis-sentinel
  jobs:
  - name: redis-sentinel
    release: redis
    properties:
      bind_static_ip: true
      password: ((redis_password))
    consumes:
      redis:
        from: redis
  instances: ((redis_instances))
  stemcell: default 
  azs: 
  - z1
  - z2
  - z3
  vm_type: default
  persistent_disk: ((redis_persistent_disk))
  networks: 
  - name: default
  
- name: sanity-tests
  jobs:
  - name: sanity-tests
    release: redis
  instances: ((redis_sanity_instances))
  stemcell: default
  azs: 
  - z1
  vm_type: ((vm_type))
  lifecycle: errand
  networks:
  - name: ((network))

variables:
- name: redis_password
  type: password

update:
  canaries: 0
  max_in_flight: 1
  serial: true
  canary_watch_time: 1000-20000
  update_watch_time: 1000-20000

addons:
- name: bpm
  jobs:
  - name: bpm
    release: bpm
