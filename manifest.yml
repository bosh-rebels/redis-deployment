name: redis

addons:
- name: bpm
  jobs:
  - name: bpm
    release: bpm

releases:
- name: redis
  sha1: ((redis_sha1))
  url: https://github.com/bosh-rebels/redis-boshrelease/releases/download/0.14.0/redis-boshrelease-0.14.0.tgz 
  version: ((redis_version)) 
- name: "bpm"
  version: "1.1.8"
  url: "https://bosh.io/d/github.com/cloudfoundry/bpm-release?v=1.1.8"
  sha1: "c956394fce7e74f741e4ae8c256b480904ad5942"

stemcells:
- os: ((stemcell_os))
  alias: ((stemcell_alias))
  version: ((stemcell_version))

instance_groups:
- name: redis
  jobs:
  - name: redis
    release: redis
    properties:
      password: ((redis-password))
  instances: 3 
  stemcell: ((stemcell_alias))
  azs: 
  - z1
  - z2
  - z3
  vm_type: ((vm_type))
  persistent_disk: ((persistent_disk))
  networks:
  - name: ((network))

- name: sanity-tests
  jobs:
  - name: sanity-tests
    release: redis
  instances: 1
  stemcell: ((stemcell_alias))
  azs: 
  - z1
  vm_type: ((vm_type))
  lifecycle: errand
  networks:
  - name: ((network))

variables:
- name: redis-password
  type: password

update:
  canaries: 0
  max_in_flight: 1
  serial: true
  canary_watch_time: 1000-20000
  update_watch_time: 1000-20000